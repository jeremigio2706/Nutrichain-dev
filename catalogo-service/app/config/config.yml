imports:
  - { resource: parameters.yml }
  - { resource: security.yml }
  - { resource: services.yml }

# Put parameters here that don't need to change on each machine where the app is deployed
# http://symfony.com/doc/current/best_practices/configuration.html#application-related-configuration
parameters:
  locale: es

framework:
  #esi:             ~
  #translator:      { fallbacks: ["%locale%"] }
  secret: "%secret%"
  router:
    resource: "%kernel.root_dir%/config/routing.yml"
    strict_requirements: ~
  form: ~
  csrf_protection: ~
  validation: { enable_annotations: true }
  #serializer:      { enable_annotations: true }
  templating:
    engines: ["twig"]
  default_locale: "%locale%"
  trusted_hosts: ~
  trusted_proxies: ~
  session:
    # http://symfony.com/doc/current/reference/configuration/framework.html#handler-id
    handler_id: session.handler.native_file
    save_path: "%kernel.root_dir%/../var/sessions/%kernel.environment%"
  fragments: ~
  http_method_override: true
  assets: ~

# Twig Configuration
twig:
  debug: "%kernel.debug%"
  strict_variables: "%kernel.debug%"

# Doctrine Configuration
doctrine:
  dbal:
    driver: pdo_pgsql
    host: "%database_host%"
    port: "%database_port%"
    dbname: "%database_name%"
    user: "%database_user%"
    password: "%database_password%"
    charset: UTF8

  orm:
    auto_generate_proxy_classes: "%kernel.debug%"
    naming_strategy: doctrine.orm.naming_strategy.underscore
    auto_mapping: true

# Monolog Configuration
monolog:
  handlers:
    main:
      type: stream
      path: "%kernel.logs_dir%/%kernel.environment%.log"
      level: debug
      channels: ["!event"]
    console:
      type: console
      channels: ["!event", "!doctrine"]

# FOS Rest Bundle
fos_rest:
  routing_loader:
    default_format: json
  view:
    view_response_listener: "force"
    formats:
      json: true
      xml: true
    templating_formats:
      html: true
    force_redirects:
      html: true
    failed_validation: HTTP_BAD_REQUEST
    default_engine: twig
  format_listener:
    rules:
      - path: ^/api
        priorities: [json, xml]
        fallback_format: json
        prefer_extension: true
      - path: ^/
        priorities: [html, json, xml]
        fallback_format: html
        prefer_extension: true

# JMS Serializer
jms_serializer:
  metadata:
    auto_detection: true

# Nelmio CORS
nelmio_cors:
  defaults:
    allow_credentials: false
    allow_origin: []
    allow_headers: []
    allow_methods: []
    expose_headers: []
    max_age: 0
    hosts: []
    origin_regex: false
    forced_allow_origin_value: ~
  paths:
    "^/api/":
      allow_origin: ["*"]
      allow_headers: ["*"]
      allow_methods: ["POST", "PUT", "GET", "DELETE", "OPTIONS"]
      max_age: 3600

# Nelmio API Doc
nelmio_api_doc:
  name: "NutriChain Catalog API"
  sandbox:
    accept_type: application/json
    body_format:
      formats: [json]
      default_format: json
    request_format:
      formats:
        json: application/json
